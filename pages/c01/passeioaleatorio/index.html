<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Passeio aleatório</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
    <link rel="stylesheet" href="/notas_sde/css/base_showaside.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Aspectos de equações diferenciais estocásticas e aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.3. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/literated/c01/simulacoes_numericas">1.4. Simulações numéricas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio">1.6. Passeio aleatório</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/relacoes_rode_sde">1.7. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Variáveis Aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/definicao_pe">3.1. Processos Estocásticos</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/convergencias">4. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/appendix">Appendix</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c01/relacoes_rode_sde"><kbd>→</kbd> 1.7. Relações entre equações estocásticas e equações aleatórias</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">1.6. Passeio aleatório</a></h1>
<p>Um outro modelo simples ilustrando os efeitos do movimento Browniano é o de um <strong>passeio aleatório</strong> &#40;ou <em>random walk</em>&#41;. Vamos pensar em um passeio aleatório unidimensional, em um conjunto discreto \(\ell \mathbb{Z}\), onde \(\ell > 0\).  A cada passo de tempo \(\tau\), uma partícula pode se movimentar para a direita ou para a esquerda, por um passo espacial \(\ell\), com probabilidade \(1/2\) em cada sentido. A motivação é que, a cada passo de tempo, a partícula será bombardeada mais de um lado do que de outro, de maneira aleatória e independente. É uma situação bastante idealizada, porque não se leva em consideração possíveis variações relativas nas quantidades de bombardeamentos.</p>
<p>Denotamos por \(p_n(m)\) a probabilidade da partícula estar na posição \(x = m\ell\), no instante \(t = n\tau\). Naturalmente, \(0 \leq p_n(m) \leq 1\), com \(\sum_{m\in \mathbb{Z}} p_n(m) = 1\), para todo \(n\in \mathbb{Z}^*\).</p>
<p>Inicialmente, em \(t = 0\), consideramos que a partícula está na <em>origem</em>, de modo que \(p_0(0) = 1\) e \(p_0(m) = 0\), para \(m\ne 0\). Vamos escrever isso, simetricamente, na forma</p>
\[
p_0 = (\ldots, 0, 0, 1, 0, 0, \ldots).
\]
<p>Após o primeiro passo, temos \(p_1(\pm 1) = 1/2\) e o \(p_1(m) = 0\) para \(m \neq \pm 1\). De outra forma, temos</p>
\[
p_1 = (\ldots, 0, 1/2, 0, 1/2, 0, \ldots).
\]
<p>No instante seguinte,</p>
\[
p_2 = (\ldots, 0, 1/4, 0, 1/2, 0, 1/4, 0, \ldots),
\]
<p>e assim por diante:</p>
\[
p_3 = (\ldots, 0, 1/4, 0, 1/2, 0, 1/4, 0, \ldots),
\]
\[
p_4 = (\ldots, 0, 1/8, 0, 3/8, 0, 3/8, 0, 1/8, 0, \ldots),
\]
\[
p_5 = (\ldots, 0, 1/16, 0, 5/16, 0, 3/8, 0, 5/16, 0, 1/16, 0, \ldots),
\]
<p>etc. Podemos continuar e buscar um padrão para a sequência, mas podemos deduzir os valores de uma forma mais simples.</p>
<p>Para uma partícula chegar na posição \(x = \ell m\) ela deve dar \(i\) passos para a direita e \(j\) passos para a esquerda, com \(i - j = m\). Para isso acontecer no passo \(m\), devemos ter \(i + j = n\). Logo, devemos ter \(i = (n + m)/2\) passos para a direita e \(j = (n - m)/2\) passos para a esquerda. Cada passo ocorre com probabilidade \(1/2\). Assim, após \(n\) passos, cada caminho ocorre com probabilidade \(1/2^n\). Resta saber quantos caminhos existem até um determinado ponto \(x = \ell m\).</p>
<p>Naturalmente, não há caminho caso \(m < -n\) ou \(m > n\). E há apenas um caminho para \(m = -n\) e \(m = n\). Mas pode haver vários caminhos ligando a outros pontos. Ou nenhum. De fato, se \(n\) e \(m\) tiverem paridades diferentes, então \(n + m\) é ímpar e não tem como darmos \(i = (n + m)/2\) passos para a direita, nem \(j = (n - m)/2\) para a esquerda. Resta, agora, saber o número de caminhos possíveis quando \(n\) e \(m\) têm a mesma paridade e \(|m| < n\).</p>
<p>Para ver isso, vamos focar no fato de que, para chegarmos em \(x = m\ell\) após \(n\) passos, devemos dar \((n + m)/2\) passos para a direita. Se, por exemplo, \(n = 6\) e \(m = 2\), devemos dar \((n + m)/2 = 4\) passos para a direita, mas eles podem acontecer a quaisquer quatro dos seis momentos entre \(\tau\) e \(n\tau\). Isso nos dá \(\left(\begin{matrix} n \\ (n + m)/2 \end{matrix}\right) = \left(\begin{matrix} 6 \\ 4 \end{matrix}\right) = 15\) possibilidades de caminhos, de um total de \(2^6\). Ou seja, \(p_6(2) = 15 / 64\). Mais geralmente, temos</p>
\[
p_n(m) = \frac{1}{2^n}\frac{n!}{\left(\frac{n + m}{2}\right)!\left(\frac{n-m}{2}\right)!}.
\]
<p>Podemos reconhecer isso como a distribuição de Bernoulli, nos dando a probabilidade de \((n+m)/2\) sucessos em \(n\) sorteios de Bernouilli com probabilidade \(1/2\) de cada realização.</p>
<h2 id="limite_contínuo"><a href="#limite_contínuo" class="header-anchor">Limite contínuo</a></h2>
<p>Assintoticamente, temos \(k! \simeq \sqrt{2\pi k} (k / e)^k\), quando \(k \rightarrow \infty\). Aplicando isso a \(n\) grande e \(|m| \ll n\), de modo que \((n\pm m)/2\) também sejam grandes, obtemos</p>
\[
p_n(m) \simeq \frac{1}{2^n}\frac{\sqrt{2\pi n} (n / e)^n}{\sqrt{\pi (n + m)} ((n + m) / 2e)^{(n + m)/2}\sqrt{\pi (n - m)} ((n - m) / 2e)^{(n - m)/2}}.
\]
<p>Simplificando, obtemos</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}}\frac{n^n}{(n + m)^{(n + m)/2}(n - m)^{(n - m)/2}}.
\]
<p>Separando a potência do numerador, obtemos</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}}\left(\frac{n}{n+m}\right)^{(n + m)/2}\left(\frac{n}{n-m}\right)^{(n - m)/2}.
\]
<p>Temos</p>
\[ \ln\left(\left(\frac{n}{n+m}\right)^{(n + m)/2}\left(\frac{n}{n-m}\right)^{(n - m)/2}\right) = \frac{n + m}{2}\ln\left(\frac{n}{n+m}\right) + \frac{n - m}{2}\ln\left(\frac{n}{n-m}\right) \\ = -\frac{n + m}{2}\ln\left(1 + \frac{m}{n}\right) - \frac{n - m}{2}\ln\left(1 - \frac{m}{n}\right).
\]
<p>Sendo \(|m| \ll n\), obtemos, pela expansão \(\ln(1 + x) = 0 + x - x^2/2 + \mathcal{O}(x^3) \approx x - x^2/2\),</p>
\[ \ln\left(\left(\frac{n}{n+m}\right)^{(n + m)/2}\left(\frac{n}{n-m}\right)^{(n - m)/2}\right) \approx -\frac{n + m}{2}\left(\frac{m}{n} + \frac{1}{2}\frac{m^2}{n^2}\right) - \frac{n - m}{2}\left(-\frac{m}{n} + \frac{1}{2}\frac{m^2}{n^2}\right) = -\frac{m^2}{2n}.
\]
<p>Portanto,</p>
\[
\left(\frac{n}{n+m}\right)^{(n + m)/2}\left(\frac{n}{n-m}\right)^{(n - m)/2} \approx e^{-\frac{m^2}{2n}}.
\]
<p>Por outro lado, usando novamente que \(|m| \ll n\), temos \(n^2 - m^2 \approx n^2\), de maneira que</p>
\[
\sqrt{\frac{2n}{\pi(n^2 - m^2)}} \approx \sqrt{\frac{2}{\pi n}}.
\]
<p>Portanto, para \(n \gg 1\) e \(|m| \ll n\), obtemos</p>
\[
p_n(m) \approx \sqrt{\frac{2}{\pi n}}e^{-\frac{m^2}{2n}}.
\]
<p>Passando para o contínuo, com \(t = n \tau\) e \(x = m \ell\) e interpretando \(p_n(m)\) como a probabilidade da partícula estar no intervalo \((m-1)\ell \leq x \leq (m+1)\ell\), no instante \(t\) e sendo \(p(t, x)\) a densidade de probabilidades no instante \(t\), temos</p>
\[ 2\ell p(t, x) \approx \sqrt{\frac{2}{\pi n}}e^{-\frac{m^2}{2n}} = \sqrt{\frac{2\tau}{\pi t}}e^{-\frac{\tau x^2}{2t\ell^2}}.
\]
<p>Logo,</p>
\[
p(t, x) \approx \sqrt{\frac{\tau}{2\ell^2 \pi t}} e^{-\frac{\tau x^2}{2t\ell^2}} = \frac{1}{\sqrt{4\pi a t}} e^{-\frac{x^2}{4a t}},
\]
<p>onde fizemos</p>
\[
a = \frac{\ell^2}{2\tau}.
\]
<p>Obtivemos, assim, que, para cada \(t\), a função \(x \mapsto p(t, x)\) é uma Gaussiana com variância \(\sigma^2 = 2at\).</p>
<p>Observe que podemos pensar esse processo limite como tomando \(\ell, \tau \rightarrow 0\) mas mantendo a relação \(a = \ell^2/2\tau\) fixa. Ou seja, \(\tau\) converge para zero muito mais rápido do que \(\ell\). Em particular, fixados \(x \approx m\ell\) e \(t \approx n\tau\), e fazendo \(\ell, \tau\) irem para zero, com \(a = \ell^2/2\tau\) fixo, vemos que \(m, n\rightarrow \infty\) &#40;exceto quando \(t\) e/ou \(x\) são nulos&#41;, com \(n\) crescendo muito mais rápido que \(m\), garantindo a condição de que \(|m| \ll n\). Assim, a aproximação acima para \(p_n(m)/2\ell\) converge, de fato, para \(p(t, x)\).</p>
<p>Observe, ainda, a semelhança entre a definição de \(a\) acima e de \(D\) no modelo de Einstein, onde, no primeiro caso, o passo é fixo, enquanto que, no segundo caso, o passo é uma variável aleatória:</p>
\[
a = \frac{\ell^2}{2\tau}, \qquad D = \frac{\mathbb{E}(\ell^2)}{2\tau}.
\]
<h2 id="equação_de_diffusão"><a href="#equação_de_diffusão" class="header-anchor">Equação de diffusão</a></h2>
<p>Podemos reconhecer, pela fórmula acima, que a evolução, no tempo, da distribuição de probabilidades \(p(t, x)\) para a posição da partícula satisfaz a equação de difusão &#40;e.g. equação do calor&#41;</p>
\[
\frac{\partial p}{\partial t^2} = a\frac{\partial p}{\partial x^2},
\]
<p>onde \(a\) representa o coeficiente de difusão &#40;térmica, no caso do calor&#41;.</p>
<h2 id="caminho_percorrido"><a href="#caminho_percorrido" class="header-anchor">Caminho percorrido</a></h2>
<p>Sendo \(x \mapsto p(t, x)\) uma Gaussiana com variância \(\sigma^2 = 2at\). O valor esperado para a distância percorrida por um conjunto de partículas, após um instante \(t\), é exatamente esse desvio padrão. Ou seja, a distância quadrática média é dada por</p>
\[
\sqrt{\mathbb{E}[x^2]} = \left( \int_{\mathbb{R}} x^2 p(t, x) \;\mathrm{d}x \right)^{1/2} = \sigma = \sqrt{2 a t}.
\]
<p>Se, por outro lado, observarmos \(\mathbb{E}(|x|)\), obtemos uma distância da mesma ordem: \(\mathbb{E}(|x|) = 2\int_0^\infty x p(t, x) \;\mathrm{d}x = \sigma\sqrt{2/\pi}\).</p>
<h2 id="incrementos"><a href="#incrementos" class="header-anchor">Incrementos</a></h2>
<p>Em um instante \(t\), a distribuição normal \(\mathcal{N}(0, 2at)\) nos dá a probabilidade de encontrarmos a partícula em uma determinada posição &#40;tendo ela partido de \(x = 0\) em \(t = 0\)&#41;. Mas dada a posição da partícula no instante \(t\), a posição dessa partícula em um instante \(t + \Delta t\), com \(\Delta t > 0\) não é dada por \(\mathcal{N}(0, 2a(t+\Delta t))\) pura e simplesmente.  Temos, na verdade, uma probabilidade condicionada.</p>
<p>Pensando, novamente, no passeio aleatório, podemos imaginar um novo processo iniciando-se em \(x = X_t\) e caminhando para \(x \pm \ell\) no instante \(t + \tau\) e para algum ponto entre \(x - n\ell \leq x + m\ell \leq x + n\ell\), em instantes \(t + n\tau\). Assim, o incremento \(\Delta X = X_{t + \Delta t} - X_t\) é dado, novamente, por um passeio aleatório, só que começando de \(X_t\) e durando um intervalo de tempo \(\Delta t\). Ou seja, a lei de probabilidades para a posição \(X_{t + \Delta t}\) da partícula dado \(X_t\) é</p>
\[
X_{t + \Delta t} \sim \mathcal{N}(X_t, 2a\Delta t) = X_t + \mathcal{N}(0, 2a\Delta t).
\]
<p>Ou seja, a lei de probabilidades do incremento é</p>
\[
\Delta X = X_{t + \Delta t} - X_t \sim \mathcal{N}(0, 2a\Delta t).
\]
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Considere um passeio aleatório em três dimensões, onde o espaço é \(\ell \mathbb{Z}^3\). Cada passo pode ser em qualquer direção, com oito possíveis destinos, \((\pm \ell, \pm \ell, \pm \ell)\), cada um com probabilidade \(1/2^3 = 1/8\). Mostre que, no limite, a densidade de probabilidades \(p(t, \mathbf{x})\) da posição da partícula é dada por</p>
</li>
</ol>
\[
p(t, \mathbf{x}) = \frac{1}{(4\pi a t)^{3/2}} e^{-\frac{|\mathbf{x}|^2}{4Dt}}.
\]
<p>onde \(\mathbf{x} = (x, y, z)\), \(|\mathbf{x}| = \sqrt{x^2 + y^2 + z^2}\) e \(a\) é como no caso unidimensional.</p>
<ol>
<li><p>Uma versão bidimensional pode ser feita com passos dados por \(\ell(\cos\theta, \sin\theta)\), com \(\ell > 0\) fixo indicando o tamanho do passo e \(\theta\) uma variável aleatória com probabilidade uniforme em \([0, 2\pi]\) indicando a direção do passo. Um passeio aleatório com \(n\) passos nos leva a</p>
</li>
</ol>
\[
(X_n, Y_n) = \ell \sum_{i = 1, \ldots, n} (\cos\theta_i, \sin\theta_i).
\]
<p>onde \(\theta_i\) são \(n\) realizações da variável ângulo. Como \(\theta\) segue uma distribuição uniforme, temos \(\mathbb{E}(\cos\theta) = \mathbb{E}(\sin\theta) = 0\). Com isso, mostre que</p>
\[
\mathbb{E}((X_n, Y_n)) = (0, 0).
\]
<p>Mostre, ainda, usando também as relações \(\cos^2\theta = (1 + \cos(2\theta))/2\) e \(\sin^2\theta = (1 - \cos(2\theta))/2\), que</p>
\[
\mathbb{E}(X_n^2 + Y_n^2) = n \frac{\ell^2}{2}.
\]
<p>Ou seja, a média quadrática da distância cresce linearmente com o número de passos.</p>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c01/relacoes_rode_sde"><kbd>→</kbd> 1.7. Relações entre equações estocásticas e equações aleatórias</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: April 15, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    

  </body>
</html>
