<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Fórmula de Itô</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Equações diferenciais aleatórias e estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.3. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/literated/c01/simulacoes_numericas">1.4. Simulações numéricas de modelos de crescimento natural</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio_movBrowniano">1.6. Do passeio aleatório ao movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/relacoes_rode_sde">1.7. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_discretas">2.2. Variáveis aleatórias discretas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_continuas">2.3. Variáveis aleatórias contínuas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/media_momentos">2.4. Média, variância e outros momentos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/prob_condicionada">2.5. Probabilidade condicionada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/desigualdades">2.6. Desigualdades importantes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/multi_va">2.7. Variáveis aleatórias multivariadas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/transformacoes">2.8. Transformações de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/convergencias">2.9. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/borel_cantelli">2.10. Lema de Borel-Cantelli</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/teorema_central">2.11. Teorema Central do Limite</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/gerando_num_aleatorios">2.12. Gerando números aleatórios no computador</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/definicao_pe">3.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/processos_discretos">3.2. Processos discretos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/processos_continuos">3.3. Processos contínuos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/tipos_processos">3.4. Tipos de processos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/filtracao">3.5. Filtração</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/cadeias_markov">3.6. Processos de Markov</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Processos de Wiener</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/definicao_processo_wiener">4.1. Definição</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/existencia_processo_wiener">4.2. Existência de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/simetrias_wiener">4.3. Simetrias do processo de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/naodiferenciabilidade_wiener">4.4. Não-diferenciabilidade quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/variacao_ilimitada_wiener">4.5. Variação ilimitada quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/simulacoes_wiener">4.6. Simulações de processos de Wiener</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Integração estocástica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/integral_riemann">5.1. Integrais de Riemann</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/integral_riemannstieltjes">5.2. Integrais de Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/integral_dualidade">5.3. Integrais via dualidade</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/riemann_wiener">5.4. Limites de somatórios à la Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/integral_ito">5.5. Integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/integral_ito_propriedades">5.6. Propriedades da integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/formula_ito">5.7. Fórmula de Itô</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Equações diferenciais aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/existence_solutions_rde">6.1. Existência de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/simple_examples_rde">6.2. Exemplos simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/logistic_rde">6.3. Equação logística aleatória</a></li>
    </div>
    <div class="menu-level-1">
    <li>7. Equações diferenciais estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/setting">7.1. Interpretação da equação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/existence_solutions_sde">7.2. Existência de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/geometric_brownian">7.3. Movimento Browniano geométrico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/ornstein_uhlenbeck">7.4. Processo de Ornstein-Uhlenbeck</a></li>
    </div>
    <div class="menu-level-1">
    <li>Apêndice</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_fund_kolmogorov">Teorema Fundamental de Kolmogorov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_extension_kolmogorov">Teorema de Extensão de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c05/integral_ito_propriedades">5.6. Propriedades da integral de Itô <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c06/existence_solutions_rde"><kbd>→</kbd> 6.1. Existência de soluções</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">5.7. Fórmula de Itô</a></h1>
<p>Uma outro propriedade fundamental da integral de Itô diz respeito a uma fórmula relacionada a mudanças de variáveis.</p>
<p>Considere um processo real \(\{X_t\}_{t \geq 0}\) e uma função real contínua \(u:\mathbb{R} \rightarrow \mathbb{R}\). Podemos definir um outro processo \(\{Y_t\}_{t \geq 0}\) através de</p>
\[
Y_t = u(X_t).
\]
<p>A questão é sobre a relação entre \(\mathrm{d}Y_t\) e \(\mathrm{d}X_t\).</p>
<p>Caso \(u\) e \(\{X_t\}_{t \geq 0}\) fossem diferenciáveis, então \(\mathrm{d}Y_t/\mathrm{d}t = u'(X_t)\mathrm{d}X_t/\mathrm{d}t\). Poderíamos, nesse caso, escrever \(\mathrm{d}Y_t = u'(X_t)\mathrm{d}X_t\), no sentido da integral de Riemann-Stieltjes \(\int H_t \mathrm{d}Y_t = \int H_t u'(X_t)\mathrm{d}X_t\), para um processo arbitrário \(\{H_t\}_{t \geq 0}\).</p>
<p>No caso em que \(u\) ainda é diferenciável mas \(\{X_t\}_{t \geq 0}\) é apenas de variação limitada, então \(\{Y_t\}_{t \geq 0}\) também é de variação limitada e ainda podemos dizer que \(\mathrm{d}Y_t = u'(X_t)\mathrm{d}X_t\).</p>
<p>Mas e no caso em que \(X_t\) não é nem de variação limitada? Nesse caso, podemos considerar a integral de Itô em relação a \(\{X_t\}_{t \geq 0}\). &#40;Assumindo que esse processo seja uma Martingale, então \(\{Y_t\}_{t \geq 0}\) também é uma Martingale e a integral de Itô a seu respeito está bem definida&#41;. Porém, isso nos trará uma correção na fórmula acima.</p>
<p>Mais precisamente, isso nos dará uma fórmula útil, contendo um termo extra, no caso em que \(\{X_t\}_{t\geq 0}\) tem uma forma especial, que o torna um tipo de processo conhecido como processo de Itô, que introduzimos a seguir.</p>
<p>Essa mesma análise pode ser feita no caso em que \(u\) depende também da variável temporal, i.e. \(u:[0, \infty) \times \mathbb{R} \rightarrow \mathbb{R}\). Nesse caso, temos</p>
\[
Y_t = u(t, X_t).
\]
<p>Denotamos o primeiro caso por <em>autônomo</em> e este, por <em>não-autônomo.</em></p>
<h2 id="processo_de_itô"><a href="#processo_de_itô" class="header-anchor">Processo de Itô</a></h2>
<p>Um <strong>processo de Itô</strong> é um processo \(\{X_t\}_{t \geq 0}\) satisfazendo uma equação estocástica da forma</p>
\[
\mathrm{d}X_t = A_t \;\mathrm{d}t + B_t \;\mathrm{d}W_t,
\]
<p>onde \(\{W_t\}_{t \geq 0}\) é um processo de Wiener e \(\{A_t\}_{t \geq 0}\) e \(\{B_t\}_{t \geq 0}\) são não-antecipativos em relação ao processo de Wiener.</p>
<h2 id="fórmula_de_itô_no_caso_autônomo"><a href="#fórmula_de_itô_no_caso_autônomo" class="header-anchor">Fórmula de Itô no caso autônomo</a></h2>
<p>Considere, então, um processo \(\{H_t\}_{t \geq 0}\) com caminhos amostrais quase certamente contínuos. Aproximemos a sua integral de Itô em relação a \(\{Y_t\}_{t \geq 0}\) por somas parciais, em relação a malhas temporais \(0 = t_0 < t_1 < \cdots < t_n = T\) com \(\max_{j=1, \ldots, n}\{t_j  - t_{j-1}\} \rightarrow 0\):</p>
\[
\int_0^t H_t \;\mathrm{d}Y_t = \lim \sum_{j=1}^n H_{t_{j-1}} (Y_{t_j} - Y_{t_{j-1}}).
\]
<p>Assumindo, agora, que \(u\) é duas vezes continuamente diferenciável, podemos escrever</p>
\[
\begin{align*}
Y_{t_j} - Y_{t_{j-1}} = u(X_{t_j}) - u(X_{t_{j-1}}) & = u'(X_{t_{j-1}})(X_{t_j} - X_{t_{j-1}}) + \int_{X_{t_{j-1}}}^{X_{t_j}} u''(x)(X_{t_j} - x) \;\mathrm{d}x \\
& = u'(X_{t_{j-1}})(X_{t_j} - X_{t_{j-1}}) \\
& \qquad + \frac{1}{2}u''(X_{t_{j-1}})(X_{t_j} - X_{t_{j-1}})^2 \\
&  \qquad + \int_{X_{t_{j-1}}}^{X_{t_j}} (u''(x) - u''(X_{t_{j-1}}))(X_{t_j} - x) \;\mathrm{d}x.
\end{align*}
\]
<p>Assim, as somas parcias são dadas por</p>
\[
\begin{align*}
\sum_{j=1}^n H_{t_{j-1}} (Y_{t_j} - Y_{t_{j-1}}) & = \sum_{j=1}^n H_{t_{j-1}} u'(X_{t_{j-1}})(X_{t_j} - X_{t_{j-1}}) \\
& \qquad + \frac{1}{2} \sum_{j=1}^n H_{t_{j-1}} u''(X_{t_{j-1}})(X_{t_j} - X_{t_{j-1}})^2 \\
& \qquad + \sum_{j=1}^n H_{t_{j-1}} \int_{X_{t_{j-1}}}^{X_{t_j}} (u''(x) - u''(X_{t_{j-1}}))(X_{t_j} - x) \;\mathrm{d}x.
\end{align*}
\]
<p>No limite, o primeiro termo converge para uma integral de Itô; o último termo converge para zero, graças à continuidade da segunda derivada de \(u = u(x)\); e o segundo podemos escrever informalmente como uma integral com \((\mathrm{d}X)^2\). Assim, obtemos</p>
\[
\int_0^T H_t \;\mathrm{d}Y_t = \int_0^T H_t u'(X_t)\;\mathrm{d}X_t + \frac{1}{2}\int_0^T H_t u''(X_t)\;(\mathrm{d}X_t)^2.
\]
<p>No caso em que \(\{X_t\}_{t \geq 0}\) é o processo de Wiener \(\{W_t\}_{t \geq 0}\), então &quot;\((\mathrm{d}W_t) = dt\)&quot;, de modo que \(Y_t = u(W_t)\) é tal que</p>
\[
\int_0^T H_t \;\mathrm{d}Y_t = \int_0^T H_t u'(W_t)\;\mathrm{d}W_t + \frac{1}{2}\int_0^T H_t u''(W_t)\;\mathrm{d}t.
\]
<p>Mais precisamente, podemos obter isso, rigorosamente, das somas parciais, mostrando que</p>
\[
\frac{1}{2} \sum_{j=1}^n H_{t_{j-1}} u''(W_{t_{j-1}})(W_{t_j} - W_{t_{j-1}})^2 \rightarrow \frac{1}{2}\int_0^T H_t u''(W_t)\;\mathrm{d}t.
\]
<p>Isso segue do fato de que \(\mathbb{E}\left[(W_{t_j} - W_{t_{j-1}})^2\right] = t_j - t_{j-1}\) e de que momentos de ordem mais alta dependem de potências também maiores de \(t_j - t_{j-1}\). Mostra-se, então, que o valor esperado desse termo converge para a integral em \(\mathrm{d}t\) e a variância converge para zero, nos dando a convergência em probabilidade.</p>
<p>Mais geralmente, se \(\{X_t\}_{t \geq 0}\) é um processo de Itô satisfazendo</p>
\[
\mathrm{d}X_t = A_t\;\mathrm{d}t + B_t\;\mathrm{d}W_t,
\]
<p>então</p>
\[
(\mathrm{d}X_t)^2 \sim A_t^2\;(\mathrm{d}t)^2 + 2A_tB_t\;\mathrm{d}t\;\mathrm{d}W_t + B_t^2\;(\mathrm{d}W_t)^2.
\]
<p>como, no limite, no sentido integral, \((\mathrm{d}t)^2 = 0\), \(\mathrm{d}t\;\mathrm{d}W_t = 0\) e \((\mathrm{d}W_t)^2 = \mathrm{d}t\), então</p>
\[
\int_0^T H_t \;\mathrm{d}Y_t = \int_0^T A_t H_t u'(X_t) \;\mathrm{d}t + \int_0^T B_t H_t u'(X_t)\;\mathrm{d}W_t + \frac{1}{2}\int_0^T B_t^2 H_t u''(X_t)\;\mathrm{d}t.
\]
<p>Ou seja, obtemos a <strong>fórmula de Itô</strong> no caso autônomo:</p>
\[
\mathrm{d}Y_t = A_t u'(X_t) \;\mathrm{d}t + B_t u'(X_t)\;\mathrm{d}W_t + \frac{1}{2} B_t^2 u''(X_t)\;\mathrm{d}t. 
\]
<p>Da mesma forma, uma demonstração rigorosa pode ser feita trabalhando-se diretamente com as somas parciais.</p>
<h2 id="fórmula_de_itô_no_caso_não-autônomo"><a href="#fórmula_de_itô_no_caso_não-autônomo" class="header-anchor">Fórmula de Itô no caso não-autônomo</a></h2>
<p>Quando \(u = u(t, x)\) é duas vezes continuamente diferenciável e \(\{X_t\}_{t\geq 0}\) é um processo de Itô satisfazendo</p>
\[
\mathrm{d}X_t = A_t \;\mathrm{d}t + B_t \;\mathrm{d}W_t,
\]
<p>então o processo \(\{Y_t\}_{t\geq 0}\) definido por \(Y_t = u(t, X_t)\) satisfaz a <strong>fórmula de Itô</strong> no caso não-autônomo, a saber</p>
\[
\mathrm{d}Y_t = u_t(t, X_t)\;\mathrm{d}t + u_x(t, X_t)\;\mathrm{d}X_t + \frac{1}{2} u_{xx}\;\mathrm{d}t.
\]
<p>Para lembrar dessa fórmula, pense nas seguintes identidades &quot;informais&quot; &#40;ou seja, sem significado rigoroso&#41;</p>
\[
\begin{align*}
\mathrm{d}Y_t & = u_t\;\mathrm{d}t + u_x\;\mathrm{d}X_t + \frac{1}{2} u_{tt}\;(\mathrm{d}t)^2 + u_{tx} \;\mathrm{d}t \;\mathrm{d}X_t + \frac{1}{2} u_{xx}\;(\mathrm{d}X_t)^2, \\
(\mathrm{d}X_t)^2 & = \left(A_t \;\mathrm{d}t + B_t \;\mathrm{d}W_t\right)^2 = A_t^2\;(\mathrm{d}t)^2 + 2A_tB_t \;\mathrm{d}t\;\mathrm{d}W_t + B_t^2\;(\mathrm{d}W_t)^2,
\end{align*}
\]
<p>junto com</p>
\[
\begin{align*}
(\mathrm{d}t)^2 & = 0, \\
\mathrm{d}t\;\mathrm{d}W_t & = 0, \\
(\mathrm{d}W_t)^2 & = \mathrm{d}t.
\end{align*}
\]
<p>Combinadas, chegamos na fórmula de Itô.</p>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c05/integral_ito_propriedades">5.6. Propriedades da integral de Itô <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c06/existence_solutions_rde"><kbd>→</kbd> 6.1. Existência de soluções</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: July 07, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    

  </body>
</html>
