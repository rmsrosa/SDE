<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Convergência do método de Euler-Maruyama</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Equações diferenciais aleatórias e estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.3. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/literated/c01/simulacoes_numericas">1.4. Simulações numéricas de modelos de crescimento natural</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio_movBrowniano">1.6. Do passeio aleatório ao movimento Browniano</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_discretas">2.2. Variáveis aleatórias discretas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_continuas">2.3. Variáveis aleatórias contínuas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/media_momentos">2.4. Média, variância e outros momentos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/prob_condicionada">2.5. Probabilidade condicionada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/desigualdades">2.6. Desigualdades importantes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/multi_va">2.7. Variáveis aleatórias multivariadas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/transformacoes">2.8. Transformações de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/convergencias">2.9. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/borel_cantelli">2.10. Lema de Borel-Cantelli</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/teorema_central">2.11. Teorema Central do Limite</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. O método de Monte-Carlo</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/monte_carlo">3.1. O método de Monte-Carlo no estudo de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/histograma">3.2. Histograma - estimando a distribuição de probabilidades</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/gerando_num_aleatorios">3.3. Gerando números aleatórios no computador</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/definicao_pe">4.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_discretos">4.2. Processos discretos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_continuos">4.3. Processos contínuos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/tipos_processos">4.4. Tipos de processos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/filtracao">4.5. Filtração</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/cadeias_markov">4.6. Processos de Markov</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Processos de Wiener</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/definicao_processo_wiener">5.1. Definição</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/existencia_processo_wiener">5.2. Existência de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/simetrias_wiener">5.3. Simetrias de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/naodiferenciabilidade_wiener">5.4. Não diferenciabilidade quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/variacao_ilimitada_wiener">5.5. Variação ilimitada quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Integração estocástica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemann">6.1. Integrais de Riemann</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemannstieltjes">6.2. Integrais de Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_dualidade">6.3. Integrais via dualidade</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/riemann_wiener">6.4. Limites de somatórios à la Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito">6.5. Integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_propriedades">6.6. Propriedades da integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/formula_ito">6.7. Fórmula de Itô</a></li>
    </div>
    <div class="menu-level-1">
    <li>7. Equações diferenciais aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/existence_solutions_rde">7.1. Existência e unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/basic_examples_rde">7.2. Exemplos básicos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/logistic_rde">7.3. Equação logística aleatória</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Equações diferenciais estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/setting">8.1. Interpretação da equação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde_particulares">8.2. Existência de soluções em casos particulares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde">8.3. Existência de soluções no caso geral</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/unicidade_sol_sde">8.4. Unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/continuidade_caminhos">8.5. Continuidade dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/linear_sde">8.6. Resolução de equações lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/geometric_brownian">8.7. Movimento Browniano geométrico e o preço de ações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/brownian_bridge">8.8. Ponte Browniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ornstein_uhlenbeck">8.9. O processo de Ornstein-Uhlenbeck e a equação de Langevin</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/feynmann_kac">8.10. Fórmula de Feynman-Kac</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/relacoes_rode_sde">8.11. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Métodos numéricos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/tx_convergencia">9.1. Convergências forte e fraca</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_wiener">9.2. Simulações de processos de Wiener e browniano geométrico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/convergencia_euler_maruyama">9.3. Convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_convergencia_em">9.4. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/heun">9.5. Método de Heun</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/milstein">9.6. O método de Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_milstein">9.7. Simulações Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/sciml">9.8. Usando o ambiente SciML da linguagem Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Evolução da função densidade de probabilidade</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/deterministic">10.1. Evolução no caso de equações determinísticas</a></li>
    </div>
    <div class="menu-level-2">
    <li>10.2. Evolução no caso de equações aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li>10.3. Kolmogorov backward equation</li>
    </div>
    <div class="menu-level-2">
    <li>10.4. Kolmogorov forward equation</li>
    </div>
    <div class="menu-level-2">
    <li>10.5. Evolução no caso de equações estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li>10.6. Soluções estacionárias</li>
    </div>
    <div class="menu-level-2">
    <li>10.7. Métodos numéricos</li>
    </div>
    <div class="menu-level-1">
    <li>11. Sistemas de equações aleatórias</li>
    </div>
    <div class="menu-level-1">
    <li>12. Sistemas de equações estocásticas</li>
    </div>
    <div class="menu-level-1">
    <li>Apêndice</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_fund_kolmogorov">Teorema Fundamental de Kolmogorov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_extension_kolmogorov">Teorema de Extensão de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_wiener">9.2. Simulações de processos de Wiener e browniano geométrico <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_convergencia_em"><kbd>→</kbd> 9.4. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">9.3. Convergência do método de Euler-Maruyama</a></h1>
<p>No caso determinístico, de uma equação diferencial</p>
\[
\frac{\mathrm{d}x}{\mathrm{d}t} = f(x),
\]
<p>com condição inicial \(x(0) = x_0\), o método de Euler</p>
\[
x_{j} = x_{j-1} + \Delta t f(x_j), \qquad x_j|_{j = 0} = x_0,
\]
<p>em uma malha temporal uniforme \(t_j = jT/n\), \(j = 0, \ldots, n\), com \(\Delta t = T/n\), converge uniformemente, no intervalo \([0, T]\), para a solução do problema de valor inicial. Além disso, essa convergência é de ordem um. Mais precisamente, existe \(C > 0\) e \(\delta > 0\) tais que</p>
\[
\max_{j}|x(t_j) - x_j| \leq C \Delta t, \qquad 0 < \Delta t \leq \delta.
\]
<p>Isso sob a hipótese de \(f\) ser localmente Lipschitz contínua.</p>
<p>Por outro lado, no caso estocástico, com um ruído multiplicativo \(g = g(X_t),\)</p>
\[
\mathrm{d}X_t = f(X_t)\mathrm{d}t + g(X_t)\mathrm{d}W_t, \qquad t \geq 0,
\]
<p>com uma condição inicial</p>
\[
\left.X_t\right|_{t = 0} = X_0,
\]
<p>a convergência <em>forte</em> é apenas de ordem \(1/2\) e isso sob as hipóteses de \(f\) e \(g\) serem <em>globalmente</em> Lipschitz contínua. Mas é importante ressaltar que isso acontece no caso multiplicativo. Se o ruído for aditivo, \(g(X_t) = \sigma\) &#40;ou, mais geralmente, \(g(t, X_t) = g(t)\)&#41;, então ainda temos a convergência forte de ordem \(1\).</p>
<p>A diferença, no caso multiplicativo, vem, essencialmente, do fato de que, na equação estocástica, além dos termos de erro da ordem de \(\Delta t\), há termos da ordem de \(\Delta W\). Em um sentido apropriado, vale \((\Delta W)^2 \sim \Delta t\), o que nos dá um erro da ordem de \((\Delta t)^{1/2}\).</p>
<p>Outro ponto importante é que, no caso discreto, a constante \(C\) que aparece na ordem de convergência depende da condição inicial e explora o fato de que, com a condição inicial fixa, podemos limitar a solução exata e a aproximação. Por outro lado, no caso estocástico, considera-se, implicitamente, diversas condições iniciais \(X_0(\omega)\) e não temos esse controle, por isso a necessidade de se assumir que os termos \(f\) e \(g\) sejam globalmente Lipschitz contínuos.</p>
<p>Por último, um detalhe um pouco mais técnico, é que, enquanto no caso discreto estimamos diretamente a diferença \(|x(t_j) - x_j^n|\), no caso estocástico precisamos nos ancorar na isometria de Itô, de modo que o mais natural é olharmos para \(\mathbb{E}\left[|X_{t_j} - X_j^n|^2 \right]\).</p>
<p>Vejamos os detalhes.</p>
<h2 id="convergência_no_caso_determinístico"><a href="#convergência_no_caso_determinístico" class="header-anchor">Convergência no caso determinístico</a></h2>
<p>Primeiramente, temos que</p>
\[
x(t_j) = x(t_{j-1}) + \int_{t_{j-1}}^{t_j} x'(s)\;\mathrm{d}s = x(t_{j-1}) + \Delta t x'(t_{j-1}) + \int_{t_{j-1}}^{t_j} (x'(s) - x'(t_{j-1}))\;\mathrm{d}s.
\]
<p>De acordo com a equação diferencial,</p>
\[
x(t_j) = x(t_{j-1}) + \Delta t f(x(t_{j-1})) + \int_{t_{j-1}}^{t_j} (f(x(s)) - f(x(t_{j-1})))\;\mathrm{d}s.
\]
<p>Assim, nos pontos \(j = 1, \ldots, n\) da malha,</p>
\[
|x(t_j) - x_j| \leq | x(t_{j-1}) - x_{j-1} | + \Delta t |f(x(t_{j-1})) - f(x_{j-1})| + \int_{t_{j-1}}^{t_j} |f(x(s)) - f(x(t_{j-1}))|\;\mathrm{d}s.
\]
<p>Usando que \(f\) é localmente Lipschitz contínua e denotando por \(L\) a constante de Lipschitz em uma região limitada mas suficientemente grande para conter as soluções da equação diferencial original e de sua aproximação numérica, obtemos</p>
\[
|x(t_j) - x_j| \leq |x(t_{j-1}) - x_{j-1}| + L \Delta t |x(t_{j-1}) - x_{j-1}| + L \int_{t_{j-1}}^{t_j} |x(s) - x(t_{j-1})|\;\mathrm{d}s.
\]
<p>O integrando do último termo pode ser estimado por</p>
\[
\begin{align*}
\int_{t_{j-1}}^{t_j} |x(s) - x(t_{j-1})|\;\mathrm{d}s & \leq \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s |x'(\tau)|\;\mathrm{d}\tau\;\mathrm{d}s \\
& \leq \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s |f(x(\tau))|\;\mathrm{d}\tau\;\mathrm{d}s \\
& \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \left(|f(x(\tau)) - f(0)| + |f(0)|\right)\;\mathrm{d}\tau\;\mathrm{d}s \\
& L \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \left(|x(\tau)| + |f(0)|\right) \;\mathrm{d}\tau\;\mathrm{d}s \\
& \leq L M \Delta t^2,
\end{align*}
\]
<p>onde</p>
\[
M = |f(0)| + \max_{0 \leq t \leq T} |x(t)|.
\]
<p>Assim,</p>
\[
|x(t_j) - x_j| \leq (1 + L\Delta t)|x(t_{j-1}) - x_{j-1}| + M \Delta t^2.
\]
<p>Iterando essa estimativa, chegamos a</p>
\[
\begin{align*}
|x(t_j) - x_j| & \leq (1 + L\Delta t)^2|x(t_{j-2}) - x_{j-2}| + M \Delta t^2(1 + (1 + L\Delta t)) \\
& \leq \ldots \\
& \leq (1 + L\Delta t)^j|x(t_0) - x_0| + M \Delta t^2(1 + (1 + L\Delta t) + \ldots + (1 + L\Delta t)^{j-1}) \\
& \leq e^{LT}|x(t_0) - x_0| + \frac{M}{L}e^{LT}\Delta t.
\end{align*}
\]
<p>Considerando que \(x_0 = x(t_0)\), obtemos</p>
\[
\max_j |x(t_j) - x_j| \leq \frac{M}{L}e^{LT}\Delta t,
\]
<p>mostrando que é o método de Euler é de primeira ordem.</p>
<h2 id="convergência_no_caso_aleatório"><a href="#convergência_no_caso_aleatório" class="header-anchor">Convergência no caso aleatório</a></h2>
<h2 id="convergência_no_caso_estocástico_multiplicativo"><a href="#convergência_no_caso_estocástico_multiplicativo" class="header-anchor">Convergência no caso estocástico multiplicativo</a></h2>
<p>Considere, agora, a equação estocástica</p>
\[
\mathrm{d}X_t = f(X_t)\mathrm{d}t + g(X_t)\mathrm{d}W_t, \qquad t \geq 0,
\]
<p>com uma condição inicial</p>
\[
\left.X_t\right|_{t = 0} = X_0.
\]
<p>Nesse caso, temos</p>
\[
X_t = X_0 + \int_0^t f(X_s)\;\mathrm{d}s + \int_0^t g(X_s)\;\mathrm{d}W_s.
\]
<p>Já a aproximação pelo método de Euler-Maruyama é dada por</p>
\[
X_j^n = X_{j-1}^n + f(X_{j-1}^n) \Delta t + g(X_{j-1}^n) \Delta W_j,
\]
<p>onde \(X_0^n = X_0\) e \(\Delta W_j\).</p>
<p>Assumimos \(f\) e \(g\) globalmente Lipschitz contínuas, com constantes de Lipschitz \(L_f\) e \(L_g\), respectivamente.</p>
<p>Para fazermos uso da isometria de Itô, vamos estimar a média quadrática do erro. Mais precisamente, vamos estimar</p>
\[
D_j = \max_{i = 0, \ldots, j} \mathbb{E}\left[ |X_{t_i} - X_i^n|^2\right]
\]
<p>Para efeito de comparação, temos</p>
\[
X_{t_j} = X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_s)\;\mathrm{d}s + \int_0^t g(X_s)\;\mathrm{d}W_s.
\]
<p>Assim,</p>
\[
\begin{align*}
X_{t_j} - X_j^n & = X_{t_{j-1}} - X_{j-1}^n \\
& \qquad + \int_{t_{j-1}}^{t_j} f(X_s) \;\mathrm{d}s - f(X_{j-1}^n) \Delta t \\
& \qquad + \int_{t_{j-1}}^{t_j} g(X_s)\;\mathrm{d}W_s - g(X_{j-1}^n) \Delta W_j \\
& = X_{t_{j-1}} - X_{j-1}^n \\
& \qquad + \int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{j-1}^n))\;\mathrm{d}s \\
& \qquad + \int_{t_{j-1}}^{t_j} (g(X_s) - g(X_{j-1}^n))\;\mathrm{d}W_s \\
& = X_{t_{j-1}} - X_{j-1}^n \\
& \qquad + \int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{t_{j-1}}))\;\mathrm{d}s \\
& \qquad + \int_{t_{j-1}}^{t_j} (f(X_{t_{j-1}}) - f(X_{j-1}^n))\;\mathrm{d}s \\
& \qquad + \int_{t_{j-1}}^{t_j} (g(X_s) - g(X_{t_{j-1}}))\;\mathrm{d}W_s \\
& \qquad + \int_{t_{j-1}}^{t_j} (g(X_{t_{j-1}}) - g(X_{j-1}^n))\;\mathrm{d}W_s
\end{align*}
\]
<p>Elevando ao quadrado e usando que \((a_1 + \ldots + a_5)^2 \leq 5(a_1^2 + \ldots + a_5^2)\), </p>
\[
\begin{align*}
\left| X_{t_j} - X_j^n \right|^2 & \leq 5\left| X_{t_{j-1}} - X_{j-1}^n \right|^2 \\
& \qquad + 5\left| \int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{t_{j-1}}))\;\mathrm{d}s \right|^2 \\
& \qquad + 5\left| \int_{t_{j-1}}^{t_j} (f(X_{t_{j-1}}) - f(X_{j-1}^n))\;\mathrm{d}s \right|^2 \\
& \qquad + 5\left| \int_{t_{j-1}}^{t_j} (g(X_s) - g(X_{t_{j-1}}))\;\mathrm{d}W_s \right|^2 \\
& \qquad + 5\left| \int_{t_{j-1}}^{t_j} (g(X_{t_{j-1}}) - g(X_{j-1}^n))\;\mathrm{d}W_s \right|^2 
\end{align*}
\]
<p>Os dois primeiros termos integrais podem ser estimados por</p>
\[
\begin{align*}
\left| \int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{t_{j-1}}))\;\mathrm{d}s \right|^2 & \leq (t_j - t_{j-1})\int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{t_{j-1}}))^2\;\mathrm{d}s \\
& \leq L_f^2(t_j - t_{j-1})\int_{t_{j-1}}^{t_j} |X_s - X_{t_{j-1}}|^2\;\mathrm{d}s
\end{align*}
\]
<p>e</p>
\[
\begin{align*}
\left| \int_{t_{j-1}}^{t_j} (f(X_{t_{j-1}}) - f(X_{j-1}^n))\;\mathrm{d}s \right|^2 & \leq (t_j - t_{j-1})\int_{t_{j-1}}^{t_j} (f(X_{t_{j-1}}) - f(X_{j-1}^n))^2\;\mathrm{d}s \\
& \leq L_f^2(t_j - t_{j-1})\int_{t_{j-1}}^{t_j} |X_{t_{j-1}} - X_{j-1}^n|^2\;\mathrm{d}s \\
& \leq L_f^2(t_j - t_{j-1})^2|X_{t_{j-1}} - X_{j-1}^n|^2
\end{align*}
\]
<p>O nosso objetivo é estimar a média quadrática. Com isso em mente, vemos que</p>
\[
\mathbb{E}\left[\left| \int_{t_{j-1}}^{t_j} (f(X_s) - f(X_{t_{j-1}}))\;\mathrm{d}s \right|^2\right] \leq L_f^2(t_j - t_{j-1})\int_{t_{j-1}}^{t_j} \mathbb{E}\left[|X_s - X_{t_{j-1}}|^2\right]\;\mathrm{d}s
\]
<p>e</p>
\[
\mathbb{E}\left[\left| \int_{t_{j-1}}^{t_j} (f(X_{t_{j-1}}) - f(X_{j-1}^n))\;\mathrm{d}s \right|^2\right] \leq L_f^2(t_j - t_{j-1})^2\mathbb{E}\left[|X_{t_{j-1}} - X_{j-1}^n|^2\right].
\]
<p>Nas integrais estocásticas, usamos a isometria de Itô:</p>
\[
\mathbb{E}\left[\left| \int_{t_{j-1}}^{t_j} (g(X_s) - g(X_{t_{j-1}}))\;\mathrm{d}W_s \right|^2\right] = \int_{t_{j-1}}^{t_j} \mathbb{E}\left[(g(X_s) - g(X_{t_{j-1}}))^2\right]\;\mathrm{d}s \leq L_g^2 \int_{t_{j-1}}^{t_j} \mathbb{E}\left[(X_s - X_{t_{j-1}})^2\right]\;\mathrm{d}s
\]
<p>e</p>
\[
\begin{align*}
\mathbb{E}\left[\left| \int_{t_{j-1}}^{t_j} (g(X_{t_{j-1}}) - g(X_{j-1}^n))\;\mathrm{d}W_s \right|^2\right] & = \int_{t_{j-1}}^{t_j} \mathbb{E}\left[(g(X_{t_{j-1}}) - g(X_{j-1}^n))^2\right]\;\mathrm{d}s \\
& \leq L_g^2 \int_{t_{j-1}}^{t_j} \mathbb{E}\left[(X_{t_{j-1}} - X_{j-1}^n)^2\right]\;\mathrm{d}s \\
& \leq L_g^2 (t_j - t_{j-1})\mathbb{E}\left[(X_{t_{j-1}} - X_{j-1}^n)^2\right].
\end{align*}
\]
<p>Juntando as estimativas, obtemos</p>
\[
\begin{align*}
\mathbb{E}\left[\left| X_{t_j} - X_j^n \right|^2\right] & \leq 5\mathbb{E}\left[\left| X_{t_{j-1}} - X_{j-1}^n \right|^2\right] \\
& \qquad + 5L_f^2(t_j - t_{j-1})\int_{t_{j-1}}^{t_j} \mathbb{E}\left[|X_s - X_{t_{j-1}}|^2\right]\;\mathrm{d}s \\
& \qquad + 5L_f^2(t_j - t_{j-1})^2\mathbb{E}\left[|X_{t_{j-1}} - X_{j-1}^n|^2\right] \\
& \qquad + 5L_g^2 \int_{t_{j-1}}^{t_j} \mathbb{E}\left[(X_s - X_{t_{j-1}})^2\right]\;\mathrm{d}s \\
& \qquad + 5L_g^2 (t_j - t_{j-1}) \mathbb{E}\left[(X_{t_{j-1}} - X_{j-1}^n)^2\right].
\end{align*}
\]
<p>Agora, usamos a continuidade da solução \(\{X_t\}_{t \geq 0}\) em média quadrática para estimar as integrais restantes.</p>
<h2 id="convergência_no_caso_estocástico_com_ruído_constante"><a href="#convergência_no_caso_estocástico_com_ruído_constante" class="header-anchor">Convergência no caso estocástico com ruído constante</a></h2>
<p>Observe, no entanto, que quando \(g(X_t) = \sigma\) é constante, os termos de ruído se cancelam, quando subtraímos \(X_j^n\) de \(X_{t_j}\). Sobram, então, apenas os termos que nos dão ordem \(1\) de convergência forte.</p>
<p>Mesmo no caso autônomo, assumindo \(g(t, X_t) = g(t)\), também se obtém ordem \(1\) de convergência forte. Nesse caso, o termo de ruído contribui com um erro da forma</p>
\[
\int_{t_{j-1}}^{t_j} (g(s) - g(t_{j-1}))\;\mathrm{d}W_s = \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^{s} g'(\tau)\;\mathrm{d}\tau\;\mathrm{d}W_s.
\]
<p>Nesse caso, usando a isometria de Itô,</p>
\[
\mathbb{E}\left[ \left| \int_{t_{j-1}}^{t_j} (g(s) - g(t_{j-1}))\;\mathrm{d}W_s\right|^2\right] = \int_{t_{j-1}}^{t_j} \mathbb{E}\left[ \left| \int_{t_{j-1}}^{s} g'(\tau)\;\mathrm{d}\tau \right|^2\right] \mathrm{d}s \leq \int_{t_{j-1}}^{t_j} (s - t_{j-1})\int_{t_{j-1}}^{s} |g'(\tau)|^2\;\mathrm{d}\tau \mathrm{d}s \leq M_g \Delta t^3,
\]
<p>onde \(M_g = \max |g'|^2 /3\).</p>
<p>Ao somarmos em \(j\), um \(\Delta t\) é aproveitando, restando \(\Delta t^2\). Ao usarmos a desigualdade de Lyapunov, isso nos dá um termos também da ordem \(\Delta t\), garantindo a ordem \(1\) de convergência forte.</p>
<h2 id="não-convergência_no_caso_estocástico_sem_condição_lipschitz_global"><a href="#não-convergência_no_caso_estocástico_sem_condição_lipschitz_global" class="header-anchor">Não-convergência no caso estocástico sem condição Lipschitz global</a></h2>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_wiener">9.2. Simulações de processos de Wiener e browniano geométrico <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_convergencia_em"><kbd>→</kbd> 9.4. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: July 23, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    

  </body>
</html>
